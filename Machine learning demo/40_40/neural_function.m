function [Y,Xf,Af] = neural_function(X,~,~)
%NEURAL_FUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 20-Jul-2021 14:09:42.
% 
% [Y] = neural_function(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.2;-2;-2;0.2;0.523598775598299];
x1_step1.gain = [3.33333333333333;0.5;0.5;3.33333333333333;0.954929658551372];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.27432360571725566967;-0.021397150352160176218;-0.21444696947802038833;0.52198465190417975279;-0.039642580618519170088;-0.038912595670237117018;-0.010876347300898496842;0.19914369305561233081;-0.979997981431152132;-1.3482257991149131371;-1.3171031509123480863;0.004481550202912630218;1.413976908573564728;0.24623694335515794451;0.53680008537457313267;0.26630476689875542951;-0.52488592334221506608;-0.46696655007295506667;0.19421358231655302951;0.076247354851033982692;0.89713948318771963297;-0.10508650734503244273;-0.2100580929184826251;0.6071835517277159866;0.38466484419598390154;0.31533134053075023706;-0.2617711375967586851;0.66929819120244327113;0.5139102040105509861;-0.23758700600391749469;0.15001920421367370695;-0.022170195045029483794;0.093707359317892285899;0.012893116733936459822;-0.13122595927744126754;0.14676062586065793947;0.45591822403431148114;0.27564569426189694523;1.0260437078397190991;1.1131964943211087871];
IW1_1 = [0.015528493624860499264 0.59467693969063784021 -0.077692520334453396558 0.64811914108469192985 -0.11194797931550894143;0.0006278176198216543118 -0.41956051183657178116 0.40335439539666217978 -0.36756344633634291386 -0.23317275519712585274;-0.0058405725569424310137 -0.088112810886733394788 0.47318488172008549286 -0.058413519861501603248 -1.3854879035755029992;0.039726130154904316927 0.83985653668217596923 -0.098071252580949244693 0.040235285323672619062 0.63185828357476847561;-0.15753976335733282932 -0.010980111055219411373 -0.014010674583101949409 0.037637613050815477145 -0.013547470920622965707;0.056933444495072753344 0.16450210576251209083 -0.0066847240398862700292 -0.045761227830631787117 -0.13176007994268751355;0.036367167165136340956 -0.25869768095088424564 -0.32107056263128408435 0.073426928282394526848 0.025734047108964288458;0.084060356129585386831 -0.44907208788580177394 -0.31894602236051394772 0.023586305292899952674 -0.12602208028179856525;-0.73523723307167665464 0.26335351539925822006 -0.16121392380528337673 0.38462483375580230893 -0.76092762208013753344;-0.32315204784567630458 -2.235223369354022882 0.14976793066146704136 -1.3268288598657083099 1.3633365677772277813;-0.35902309291662148905 -2.4834724733316764222 -0.015918393076448274226 -1.5092293179529328029 1.494509906816157141;-0.049907023038784872893 0.63342681675373802008 -0.095250796220015213067 -0.04970367740604248602 -0.036791798716108922718;-0.015271892708310677925 0.020526112328802303963 0.041993732002192196706 -0.52154324538279228651 0.89238442151886310238;0.061552998394153297934 0.028257243304087572427 0.69970925971771258389 0.47539884512507663006 -0.53057636610131542199;0.050896089201126121226 -0.61998250097139162573 -0.21281374851799392256 0.18912830645222891701 0.63152842984381862834;0.055007627978277379155 0.25068931776415021018 -0.52179934766690616588 0.24400129791759928022 0.36825560116777089625;0.054042094099067482238 0.78997365464477542485 -0.49713394825196371984 -0.47261410997096314768 -0.10386482366759451634;-0.019280999124016134222 0.59740461892216178974 0.069251346058283314022 0.055386110079512267113 -0.37886488853971794777;-0.047888662576007011429 0.5198609469778145975 0.20762481422545767118 0.015461755275208764401 0.41526250410306853045;0.021530043235258710527 -0.092678712069836216569 -0.024925479715485539256 0.10787931799970131019 -0.94788741301842249776;-0.099380418963981559388 0.65590654166407491577 0.48404679359470231814 -0.10713155450089659193 -0.93995306824323676675;0.038599967055561283658 -0.78360404392049276545 -0.39762085813894848529 -0.022128087589091204046 -0.20184719778941923041;-0.039079210816248571847 -0.26627422169415237985 0.33098393829111927289 0.0036331228185250102718 0.31134711578391738307;0.048995841494773567648 0.82601900660643357011 0.33612720219792618925 0.70329944238991148886 -0.65039912115375975166;0.0087645741238750619201 0.64193891754072440747 -0.021712154678267561042 0.088779346274240528158 -1.0384306465209180992;-0.022816181521366149521 -0.35278396353760249626 0.42804437745982709673 -0.24079939643952130712 0.47702305565901326201;0.072001808748151083228 0.10976736801468083005 0.29448688741556233728 0.21229604305195726166 0.23131481942762108228;0.007983910518032643136 0.008199192026854859594 -0.80752866277390156213 0.31099878281057902196 0.22354104956945214377;-0.023279628403640114515 -0.071146809117020870517 -0.1356325763277173857 0.6019056383276081279 0.034198299878221337378;0.051513089475502135683 0.21957660443544196882 -0.39739246227935032252 -0.23332770543128600327 0.48211230248605724258;0.1924769713327911802 0.07109686960534167266 0.028338100053149507113 -0.0014002113570428824027 0.059017461227545330027;0.043581623894752591353 0.067721114361443929264 0.11340246214691337978 -0.18192770752748466112 -0.02226679857257481826;0.04578158322884650494 0.11367733453868168747 0.15856597463807392545 0.16062636367836435891 0.095713728247327073406;0.051563199677367284324 -0.21926100313032212408 -0.32722667470705646409 -0.34271641693825377617 -0.080186407382679653066;-0.060203980133582184198 -0.085567024314639764104 -0.29557807423098203525 0.053878986149145519091 -0.32627074965451280386;0.016841554420734865249 -0.25508579750161497479 -0.1977295076851027511 -0.089973404207965221313 0.95389334182121998662;0.066883900608807514421 0.61972858586648704726 -0.3235778934928924544 0.52815626054914344145 -0.097633006979540554182;-0.057338741421093096517 -0.45780520179809719439 -0.40304392782814113527 -0.011687284375368010153 0.27854836636217167323;0.13566538080813156375 0.85074774598361013744 -0.31445005128349762247 0.13135473417308626831 0.48331890570252916683;0.12567851672647764594 0.65711440261154041576 0.80250840724020466865 0.69965482010661050882 -1.0615828299832386072];

% Layer 2
b2 = [2.4505598400263393088;-0.25510173611554487483;2.6201168670367502855;0.41263514783253713025;-1.2104029227981736305;-0.8600591625217179903;-0.64801938379900525522;-1.7247172934309793479;0.22488937518876034316;-0.29085505203757905379;0.28672217715961295648;0.57428695701988785594;0.55531285473542024711;2.4721509262115066718;1.0234534788318616627;-1.8727582818322350278;0.29080721422908450968;0.16530124271157217719;-0.18917498282604816584;-1.2659408510883400911;1.8551077254771812797;0.26839948511137085019;0.37458423594149753422;0.020496824920608280873;-1.3210569468844703955;0.97785379330626487349;-0.24857390369109536032;0.33273869645167947207;-0.55395782315100305926;-0.80858653985203765568;0.76110977401135904152;-0.17048226802103733091;-1.153678162292849807;-0.53992769162649401071;-1.2332088882031178034;0.89360862797043005834;-0.69559570718503471731;-0.87193335491150480987;1.0412024396501644574;0.40270144256456263943];
LW2_1 = [0.46906564726932181708 -0.3886603048440099295 1.28958398647125283 -0.1453427262738482828 -1.0145837148751790657 0.36315279919299897626 0.53374135850382820045 -0.3369750303505074096 0.25537006171442333535 -0.036504177406767888969 -0.09321353915935645662 0.45764425302563427334 -0.87078842372944853523 -1.1312438497756440725 -0.33292105752913470074 -0.23564634349235358268 -0.33185982363866989298 -0.2597130588141365326 0.45461274102346288517 -0.73715714210113958416 -0.36073068739342784017 0.029046010499352705597 0.46708787246259464432 0.087627124493827993068 -0.38713713044045838796 0.58175321110360234123 0.56766832639860154153 -0.20856885184845436187 -0.26647964388351796927 -0.31760765654174610839 0.94792238459769129211 -0.69397430491034284294 -0.067426206689500486902 -0.54619066996907861267 -0.25432226805564095429 0.48010824929651141346 0.13064191645951420129 -0.15660208907104586351 -0.35948864782119821504 -0.22467104615355104613;-0.037908274827602277124 0.31702828569880564524 0.31284421008808782627 0.61369319194892013591 -0.015048547379809110169 -0.17592201922192676755 -0.91006832349763622236 -0.43794232705681235274 -0.10884691376308078259 -1.1224837411098498308 1.0283752186904859816 0.31281991432959488364 0.44147353703189151641 0.35227010851932938351 0.39733995850453374121 -0.42471746446193908708 0.097192170893911064566 -0.52393806833961797942 -0.10072293823425701453 1.414120251640601289 0.61187624838580234599 0.2233624049084421137 0.047682128937642648259 2.2489649191602745226 -1.3061529613996900601 0.45184576916692220649 -0.45032280651127604143 -0.21383905727634403005 -0.3267767140058613351 -0.29571277627851044745 0.93548685106674756007 0.41835849167561833806 -0.0071218309320055864231 -0.11395427676850403143 -0.038407211776491465005 0.88917456295619656803 0.65166963770632391206 0.0091845386030032540037 -0.70158811829816047911 -1.8796118602621942895;0.24293623380546250368 -0.37611579963688390738 0.7696392757367434001 -0.10793351080936136599 -1.1313302154021986912 -0.39523887680912372922 0.35942811190809820232 -0.25437618699194025629 0.13429842406864753168 -0.15558316476115183202 0.023723752059164059797 0.35483639406596184651 -1.0400878432256224215 -1.4814454339419000917 -0.55979958512127558912 -0.18022891074477639939 -0.056367659102375990143 0.31947185288809137882 0.18609467764406525947 -0.4258444938133053026 -0.25658364124293386865 -0.0056902070512354595289 0.42949012271839548394 0.047220256431106902295 -0.42168147972384018018 0.69973796062062609824 0.27859179036876130509 -0.43224975934340381656 -0.01328747757965233374 0.024690564843372724002 0.85906588282998463946 -0.53432564795655224099 0.65305768302381661528 -0.57159533001458573409 -0.45458040125680854171 0.57167171527388793706 0.35963296103302372364 -0.028659615287123376554 -0.40302377971763431175 -0.057015936451781282224;0.090066954463587381441 0.2034636132166295075 -0.32025137509780354783 -1.4347610113142814647 -0.45665205562095251279 -0.22243358860040141067 -0.12713765854274505784 -1.669491712887161361 0.29507615709641549229 -0.26502690107454746071 0.037126436185920458355 0.24025763229370061813 -0.58461875119951833835 -0.0059656912489928692542 0.3322943744803729671 0.25490348936691736847 -0.72127052764890087211 0.13195083464287149511 -0.86338585995779237869 -1.040772461279675154 0.78586291302153354899 0.47613867326105635547 0.5509401738449337671 -0.88451934466707193838 0.39573981345487835304 0.51650828924817093757 -0.20799974614263530559 -0.5639389319176202342 -1.2519990162921004195 -0.68670042748083437445 -0.29513534233038429822 0.094427515580558299413 0.13737023746637025412 0.21632885587710090625 0.20107851574542517925 0.73737996434665764589 0.42555304211494215938 0.82036427439637671366 1.4187065919100818601 0.20976735644874008879;-0.31039521061408570368 -0.50047062857353197263 -0.28618157487411505224 -1.4106251561166889275 0.29594835597429153262 -1.69917903392710401 -0.8567332466463789542 1.0604759301577681985 -0.29225194362260420444 -0.28704219411027981357 0.42798168882034581806 0.36544694171235675428 0.72847400207171386644 -0.15773081568077515491 0.26358932326535539081 0.26300733500208067772 -0.3593856712252163077 0.24481512627620166667 0.92197334709812739373 0.70936329627450489532 -0.11384145991864988434 -0.41630271861653356247 -0.35487984345622997084 -0.51121068098812150193 0.35227384080904661223 -0.10895357031562312444 1.0789181053556058387 -0.028959175838298795158 0.1623667675557778356 -0.36579557115795369171 -0.61135646680338884273 0.10214917072188867131 -0.30944464513883501722 0.42008791340948059556 0.90325969494028368612 -0.48218732866867336506 1.3865457598949288975 -1.0527773992337563502 0.61432623751900505837 -0.16921658895564281599;-0.54951865055259663251 0.38566080917532780115 0.31362782848880499387 0.98766451357843543235 0.074185469132364040279 0.35857813301085628144 -0.59996210563722984777 0.61164626180601278094 -0.21481936969263543125 0.32673528845229860007 -0.49452861443144163767 -1.1160145873678384287 0.22514793001039992704 -0.61018052161504454656 0.53763056072817272391 -0.85468254335223226015 1.0066530227355794391 0.95112404804921146795 -0.057669527425738977 0.073795459138593685888 -0.61020469692702961062 0.41260901082134460172 1.0995194346519032713 0.8316720399405030939 0.08903602752675709997 -0.012846273170452999005 -0.74632092128000371289 1.0593196231045562961 0.10163000631271762453 0.30555896684879030323 -0.14775664839941771156 0.49132072463143605656 0.86863269582970881189 -0.5735970523151080469 0.91613585439488220974 -0.33229339078223152359 -0.81397292107781504811 -0.28677702580732411519 -0.67679170006223121625 0.083622603007503515382;-0.49437662224879974637 -0.08449056277476284238 0.52023645421377717746 0.37606299678756638372 -0.60986593795317900479 -0.079399805092854894295 0.5917009836046778215 0.72868661386512567635 -0.9610547518441213688 -0.31306564695732785886 -0.36885241046347888583 -0.19418063083330699969 -0.061664851158020540789 0.20348819137225898634 0.10239645303439737223 -0.59680178972046649122 -0.7833610251021571047 -0.21677864463554308294 -0.86042037692254114134 -0.38568095696545690032 0.095133330547603534022 -0.10389212994645442845 0.13892402470671089132 -0.46043424297737445272 0.2792353728466561158 0.31548038768132191656 -0.35252932689277649558 -0.2191373287051507357 -0.10044629311640035363 0.048991004547616762155 -0.28758040195525375049 -0.83891986236931503917 0.16912480517499398069 0.35107580909935381941 -0.88978029352801268903 0.38395536121271567342 -0.8687378858751495514 -0.8527890466363965416 -0.71614384527923613533 -1.0544421596213489067;0.17855212957702326637 0.28678719302226002297 -0.37391743868379101468 0.48598234530539857756 0.38323499410071459881 -0.35715806659005983059 0.058983638316184396067 0.40991310890275639567 -1.276191445993069884 0.46093771582890036287 -0.22611258513272008974 -0.63975279820630570615 0.34665216619574173995 -0.38679900035296421734 0.40031402768373181011 -0.99036140889124602005 0.29451282220380536891 -0.83019319165382210457 -0.28057654971475837202 -0.6246141622057912457 -0.030458329108883606257 -0.010876727152121701617 -0.018815443755647195262 0.061405475892887306788 -0.56674211710162525346 -0.15418318346635220828 -0.2141775236100667279 0.064138601119908600356 0.903949695590710256 0.44933910113358799254 -0.14018182527787109715 -0.90955628657543241555 -0.8557610075610583289 0.11566338223443123345 -0.5372173876365058387 -0.79811937635918306366 -0.42505817726015315827 0.047267971052025077594 0.89476413394438703008 -0.017677748627146178811;0.56485990079728198854 -1.1439797095655330761 0.077780701471463126184 -0.82689591496065717457 -0.31711009789850325147 -0.72038168131038315956 -0.33298572624328204306 0.84379645519070312076 -0.092175861554297619516 -0.014374338057424137019 0.3881371611681254663 0.38716876037287245582 0.5768953702467408684 0.51220847628713961353 -1.1503722600916392871 0.075437906202930934962 -1.3060757288830600054 0.027893126294740087229 -0.42125680520409841678 -0.08607411149234320269 -0.2413108746269464755 -0.76786035681695230526 0.76305252905517040318 -0.50359181522237073114 -0.0017953137515210942574 -0.16715928626885070973 -0.78307686965059919437 -0.97392729302747960141 1.1483754038987596946 1.5475561166854368 0.28442665423036267436 0.30664981311577688139 0.60633383374261551335 1.2403530481059890089 0.62646788538463948903 -0.70435392566263566039 0.5723795979646826293 -0.52191331997947354449 0.2267835211905996351 -0.46681458263527120245;0.77246998327013771668 1.0958175363538458225 0.38291896006966308352 0.81825684875503679194 -0.29641979007237584387 0.27352416318039174392 -0.27251227852768572513 -0.82317641355808213177 -0.11874012690777467627 -0.10948459276789344885 -0.43760405998309775955 0.5150205904884102015 -0.34574532330066026775 0.14343253866981764411 0.81108331869540406522 -0.10051323535785169905 0.91151368123359344242 -0.92106770700317119882 0.90672931350398811023 0.45035101730742549409 0.13889293941626063011 -0.57873810613149179183 -0.17853886134561533505 0.64155798628412297191 0.23314191974372558414 1.1843871524277918006 -0.11403624943122109281 1.0454863252378505667 -0.71383082232614647467 0.62987440881168055284 1.3391747697493114888 -0.72649194078188084056 0.60435271595736184125 0.0019952891338712226178 -0.19902458604935716058 -0.91415354368781143179 -0.94762920323009669499 0.74226421702254452573 -1.2413109881557529146 -0.53177574067667643387;-0.21744512742374788594 -0.040209470542027045403 -0.1033254588569719884 0.24694217278946178906 -0.059743131260859602683 -0.28266368396922253448 0.67854945376284658831 0.53777969147146875706 -0.0092510664947900965449 1.4803125428416810117 -1.2654925762576390014 0.69424741804860357064 0.22438531960182489522 0.78130275630605827697 -0.51142898814899018234 -0.75160277702238875719 0.39326152987222273705 0.32538333892180065776 -0.61452306501742348654 -0.30916900577024775121 -0.50085354693454298136 -0.50153701412339490862 -0.56827030367786657283 -0.96612273637836920681 0.26901193909432263851 -0.36420440390190628177 0.55880506866900891971 1.7701581541677298137 -0.57190807032730606174 1.0312535437532548421 -0.44352031227228400079 -0.4541600663642667568 1.4659665948364963839 -0.18808740456746497749 0.12961148311323231197 0.39103786682052826817 -0.27927843561880877354 -0.0013561977406964945483 -0.031651226732051736257 0.41010146087668847281;0.56457416602318744037 -0.57914475512500629417 -0.13662663477742642559 0.79302134369842991468 -0.40106029933598641435 0.48221390176270795269 -0.84068683036037405998 0.20382614487764660893 0.12390461211176953538 0.86460584561449882468 -0.68723111209121079401 0.20155020029700634887 0.081735488369982275958 -0.18732477089579541163 -0.45459825631535821788 1.0333480169814619476 -0.67769312811285431497 -0.44585921652953586225 0.096189327176237154893 0.36299227751650281482 -0.10893941871918705333 0.57121113319510163908 0.81099319045118545279 1.0980949818554561759 -0.30956406234586386628 0.82223491860464703596 0.17881308465059431168 -0.31415310780058969264 -0.90307960847611445931 1.5459295281845801817 0.061156413859086433682 1.3818103623671935676 0.038789542834671390803 -1.0074404097867306618 1.1261586236849414622 0.93761147285331425394 0.20047843362857378779 0.83487943068548109427 0.68489076983338426086 -0.52553223290661077449;0.1897198838266493659 0.42962266706949292505 -0.71218437611364027173 -0.25725975164952791241 0.31041045246486448361 0.11913198271120427341 0.37690808426347816029 -0.25382995357417192928 0.1557673484638824879 -2.1496772809940249971 1.8194182604063944275 0.16877747481186994305 0.23688078733422693323 0.27268364577072040644 -0.69829620743996034804 -1.0448779742897296163 0.98943175395105553704 -0.077975988831083198338 -0.35556622556119532597 0.036347641626024961015 0.18376617099251318921 -0.069517190797128841639 1.3081710997121120954 0.42308576463247149491 -1.2463895443749573033 -1.0483733549870732915 0.19107404264570798658 0.18596557362395499391 0.3013096121052144527 -0.68192848385964410785 0.37023815359445266804 0.18933806284575804835 -0.44713041923289192914 0.68685472383960333165 -0.6310740318772015689 0.4402315026438424761 -0.80737458271678919086 -0.039750634344356376715 0.35024432765591062555 -0.12060735641390983586;0.9703859165454380431 0.46311164727469250613 0.22162300446348939809 0.47425678896439832366 -0.30585508392467469774 0.068498793822335229953 -0.53582726219214571461 -0.31199551289218901973 0.60082438883403033181 -0.33315022135156896477 0.76922558660039697109 -0.36080637869360976389 -0.84115554571399853145 0.52196104962217126921 0.55582440158266410712 -0.68238869386717715404 0.19325186922573781012 0.29026912622600054004 -0.31632103384445070526 -1.7966080928020209395 0.35272997007550371817 -0.31746112909888568598 -0.64389478765896790424 0.63927495388411670341 0.39858796444195759845 0.12703625751089717144 -0.22788179905531827374 0.16261045829250647676 -0.015427342350081661715 0.11100815100063983476 1.2071424513440949244 -0.4277951100877698809 0.21290163849525695072 0.46470231599269912204 0.096773832152721922517 0.79497690625210315485 -0.97486206512690920523 -0.21212967649158437355 -0.47580547426942210176 -1.4905871918280506616;0.97286359223568341648 -0.032379228829962317104 -0.8730045894955841268 0.73111166168073238314 -0.45404833586990323013 -0.48057091094484749583 -0.53003025247806123676 0.90060963889322154241 1.1320254149142900957 -0.95239877603549671914 0.84756652090952122602 0.75106880786111895887 -0.85606066859047569295 0.052275230098575056759 -0.44706246058578885672 1.0482931158959152285 1.3035301762546931403 -0.8516460263381050444 -0.24179923974951889054 1.0953823762286891697 0.81338857655389207313 1.0280328115678958323 0.84018308805860442146 1.2623379756299946131 -0.65795390746938486881 0.48933765534139550546 0.58938974570061097857 -0.41479797791442257759 -0.51773253914729833181 -0.7247649602692579629 0.089902399919590619826 0.13159759848800153814 0.11941838289142149565 -0.85729825640629431227 0.29437377218555815794 1.5880000655766057793 -0.24661414129287465014 -0.87888084141761224632 0.039986596334321083956 -0.68063277537911459625;-0.92588554001282696859 -0.059913473300590290582 0.18967217952671877601 0.65199970038785270976 0.45071369221282131523 -0.27083998795634217638 0.31688386570017357258 -0.096694805099777056401 -0.12731633431103200893 -0.91480871868406099523 1.0970497256102649253 -0.28130137541267380419 0.69071996030702287328 -0.22650904941330604614 0.01067948227647740056 -0.20518321595940453017 -0.25794631695827380247 0.84761541126139672286 -0.45819930361324151535 0.48675034310629583523 0.12156129957082471849 -0.19363674451575851876 -0.094543704515406987166 0.11686220977352665407 -0.15159457540082144078 -0.11629062230017828128 0.066972018967783084054 0.053619149250305642163 1.1387181084192583569 1.5049821014658599783 -0.043654928278654997476 0.25377278842394201952 -0.33554092226603815519 0.41187848388980158321 0.76253740718537610377 -0.5034469816968453193 0.26939277688216939355 0.053775223070438110673 -0.071248607185939907827 0.29399787275508293405;-1.0669525141363023213 0.80599392404399528012 1.6681800558817991842 0.034016225821136517049 0.22737552379312206408 -0.055290691835936531251 -0.85921828322648252652 0.31362011720673405035 1.4654198583956901114 -0.65477915271641284889 0.64263075707970973571 -0.16224951130156062273 0.31178612095985552832 0.47929654055634607346 0.28008192208232496334 -0.13442793889497262061 0.38402715785695862305 -0.57691177603632537441 0.13283760906913424926 -0.41887795702801922104 0.56169662301558431761 -0.40018578211630451147 -0.56288713308972759819 0.3336583102040613924 0.61380531173131647193 -0.68672265647026031754 1.48020589191761065 0.50009681717635701137 0.54555560903099309389 -0.37385050295865851488 0.30985296062176642673 -0.81321337182547737132 -0.085829721096613437181 0.59985957836462255877 0.96352550835175920785 -0.43791169561839904389 0.92526892757734557904 -0.71686807121731499493 -0.28878140523310780186 -0.807219714036610414;0.59016061240425843337 -0.068667889175118498879 0.13230447628838937213 -0.729037182579856613 -0.057756901125641066375 -0.46559887633584318145 0.5401638156654519074 0.10224940054351122631 -0.095366105922083499458 -0.37327935112218463276 -1.8458182336777004817 1.9006185209795345425 0.50539381723966325666 1.2372743162146870866 -0.64246594227510012143 0.38675248448840265914 -0.078090177510087982471 -0.70668967283847805572 -0.62471704663377602973 -0.28129668994206874499 -0.1152189163113647441 -0.17982760402729172644 0.85735586103569483285 0.57585187658236625108 0.083213938048534247249 -0.14342361705669415262 0.087342453422133051189 -0.48682703277994898716 -0.43781156514859054241 -0.49140741538893240037 0.61860175361370628444 0.19766282944590837789 -0.15808507757335391042 0.27154066073883104115 0.43779495390650036146 0.37559271912124053694 0.0814965302713809292 0.41151227514112587169 -0.03065595882042301823 -1.028354738170380589;0.090519842201530364978 -0.24247315359451679373 -0.94483239554163367391 -0.45686376183101062853 -0.41638767381585484184 0.3479880870570751239 1.0870663783074918651 -1.0499560496209257021 0.16295619608864136962 0.49071102153360279807 -0.88070497239981448967 -0.11241617834116222896 0.70989225421204227295 -0.11053832944828377582 -0.75809240100021635378 0.25122438075924580225 0.54280750803685506867 -1.0227836616925505275 0.015478475961615150575 0.019705502694493032267 -0.13980676466293603943 -0.1121418583270277769 -0.015954159724965260442 0.87437729492588045499 0.44780701495936348078 0.05679928491152323039 0.29686135451822148745 0.3965028585114737103 -0.45939224618690316371 -0.51909253814981193287 0.46224876447906948496 0.24450108217418617396 0.76048162887789416686 0.1701050862513083517 0.80145991566211927104 0.818123415446862845 -0.02680074253984105967 0.40067647994795302369 -0.79025786776703266234 -0.18580200273776212305;-0.77447695994978915657 -0.94881501911476706645 0.070723417288617612675 -0.27360870310512031001 -0.61257020638401671331 0.47196069652787864257 1.1468874072202634995 -0.67098486177010341347 0.014001294323464048147 0.53143999534978114685 -0.41105630237493873125 0.030261169654740131124 0.022448125109265922028 -0.2950214037735484629 -0.64780124944911843254 -0.20225942966192334005 -0.18285902335673537289 -0.1593140138207098655 -1.1079478769550445971 0.041470530009201110599 1.911319086375739662 0.22492114008491881361 -0.64116397417929815727 0.24414958274711112685 -2.0450355079007147552 -0.6863844546069436392 0.32080122824815288096 0.22723155391030011585 0.03630073628079310416 -0.09016000796523079841 0.32402842763294059658 -0.41806964653667361143 0.20859255718220306997 0.52062970700680111236 0.29838205847712689911 -1.1139001565400883376 0.59186699496328343262 1.048788755763813807 0.63598120665727120304 0.21104998277434952603;-0.5010085288963292971 0.092603776504766852073 -1.3029009407655196551 -0.57991518037994627122 0.30738170022432442785 0.49454746296059554078 -0.010612775349433171274 -0.7611664125484491894 0.069554102019077357344 -1.3836437477334595503 -0.93297871366854345787 -0.30030435268713145947 -0.57002787232440277343 0.096468849810287457536 -0.38047218947717426074 0.68276769291644057169 -0.32545691103828516821 0.96272037262283716164 0.65874224449427520867 0.56168187475252007168 0.33909817732514152544 0.21663310701680657533 -0.22641606486272383703 0.57337082729599408992 0.14126776330847942709 -0.23936541134233116357 0.86917556108011095883 0.0024988004850508755729 -0.19010423934525330636 0.099218327638347245112 0.62072687244606405965 0.64821062517309624429 0.38965970050185771978 -0.68161048074599572821 -0.45897920932023028584 0.87244338372018481742 0.2820476670113055695 -0.21692743213104326294 -0.63520619190515870134 -0.66425520959490214068;0.027652237686710295916 0.309594772434673704 0.2094587403304397355 0.75971911886790588486 -0.37367275518020409697 0.0031282056138865052194 0.10411333289556511106 -0.029651574578769414325 0.39901750698579596666 0.47767569993276154383 -0.30454975974662357174 -0.43909003404273344584 0.25200143808548636226 -0.19823620420126367159 -0.17342934226471171111 -0.91128967391749648996 -0.29440775767337323821 0.68561005090646442994 0.39484827670325972626 -0.10781590639806640231 -0.78866099744943507499 0.21036080057907627361 -0.55115015344946061138 -0.61519834088305525022 -0.94360271626025327141 -0.02589609386865316526 0.068052061511062397758 0.032278660672843906276 -0.66592622817506463839 -0.54125843000094919777 0.22895274525900072282 -0.5723102819957084364 0.59278264970509075837 -0.62388799230294789133 -0.4666398910034804115 -0.92310857324930473133 -0.70950131459080523211 0.28267553420734925496 -0.80372479230177185094 -0.32198469651432254368;-0.01649446593034034278 -0.96472794221461977138 0.021371859078500046736 0.37056699907827961304 0.27701015642307297293 0.079501427274268093859 -0.64857667613118452632 0.3930327151201867264 -0.44921706870182981364 0.3168810917537824845 0.014775157079630986401 1.309019320041540535 0.40218781911327494694 0.50042842824204847307 -0.38420427381693594837 -0.71608745504386106528 0.069067860405292474946 -0.62246247200894921914 -0.58905258706150653847 0.26135450630698231489 -0.91525875917650778568 -1.0324000796078807163 -0.58428344301150236806 -0.74961593735696085972 -0.019076614210267461846 -0.79980646339601690897 -0.45655086513972714668 -0.74857704146936931977 0.72426373166880331222 -0.35289323248651566223 -0.61636023750148294376 -0.95059440795112781775 1.6804461582495326955 0.69472127031691333077 0.27151604815291519035 -0.11503428850612056056 0.8063682088610948373 0.13279689698616800597 -0.2981212814185370541 0.20329705784550347603;-0.32493401112702530176 -1.2086160427294165842 0.25385162823123341713 -0.64004206276952702037 -1.3209871538897954846 0.15768010773873386565 -0.040105735087325816712 -0.34665304156695692095 -0.64862944001855427079 0.87279464432304521004 -0.76392021885066996312 0.20250973384763618079 -0.39829365445386688549 -0.45415683509846582755 -0.28884490991889555378 0.32126594889776466379 -1.1624952970037700783 0.5044972688839659547 0.60898185222876810574 0.92742482735562770113 -0.10985940492427202775 0.31474914311215268503 -0.02589904238440529291 -0.60267965034129578061 0.18029452673491191961 0.3636744283179769166 -0.28639221871102821249 -0.2631451180222040831 0.061479705454049696223 0.61646180602123312742 0.16233164514157191749 0.19561110867122952217 0.59041522268598956025 -0.81427927163656477205 -0.43975210332232911314 -0.5273367409894473834 0.39238024476434546495 1.0254724402810793116 0.90243133053322011072 0.53556219082665501574;-0.54338641081964123014 -0.14952772754763440921 -0.39237570017281031554 -0.12194517396128008724 0.40250231713060763417 -0.019471157343399849576 0.9541350733173646903 -0.51242885881598299047 0.072137706502373444284 0.014929453249119878019 -0.10852949494794339458 1.5200802216824227386 0.96313871898206071531 1.854535794573497709 0.31737587817747964225 -0.37661025188733282532 0.47583740720100797805 0.33956657701368242464 -0.7971747205237184053 0.19705111163555588671 0.18146175803001796112 0.18301693673192925838 -0.81053629775249480538 0.19454571400050937879 0.67130749950505741452 -0.021688120076051951163 -0.3200538324058593842 0.081525121542492459681 0.16666839372766570349 -0.65765985350812194987 0.39141950168172362501 0.45594149897707786367 0.63260734539439256174 -0.21157185446142448559 0.12967386954798845733 -0.60888170945250352784 0.90360576096871514373 -0.21168764825439589927 -0.52553583913351076262 -1.165194064214013947;0.26954538636138647423 1.1994087977009955104 -0.18895514834789373104 -0.34663622961407580814 -0.080034849785192721527 -1.3428725845502458291 -0.083762910549334754218 0.16638312754169828911 0.073022190620006643957 0.16660956884473229755 0.60336480507967482634 0.48185299850453006121 0.09388959341528071989 -0.00085799200291542931235 0.27719744701045095914 0.049506530403525844664 -0.034094365061781366222 0.58171264366979036353 -0.5908771728214327057 -0.25508509208673746382 -0.83890616142960816592 -1.4933493261640575778 -0.93281052242312623157 0.57886913348329271933 0.68530230099578093306 -0.23549845273512148847 0.44101339950523116284 0.11998322538341410493 -0.13101020439830340925 0.20513986777941184414 -0.16894927758440295151 -0.07178493492078857896 1.2928554870211188543 0.20769759368386636611 0.95036082791848042195 0.33921719578151171559 -0.38917139180661602937 0.52865361558485002291 0.32744125958368003326 -0.38384415737326765816;0.31685661462290265478 -0.25825365394105120886 -0.49610768696217089069 -0.24459374753925561263 1.6079025703312868067 -0.67909386335693489034 0.06741895079532415902 -0.10002833759237322875 0.34458460334126489455 -0.41274106893728651491 0.41687158695307774403 0.92162291883773894696 0.21813577502999770275 0.50389869071992798855 -0.91672794787912426084 1.8026403304431761754 0.062404792806529343907 -0.59552551186476943013 -0.37702774384379439399 0.92493920609176427661 0.71108306718162483939 -1.0232057862715457919 -0.38679843409037190094 -0.37346652414329611913 -0.56637852298456681233 0.44322153520236740043 0.87942123811040284753 0.088388133306344651707 -0.29298045164801078677 -0.37293310243958466277 0.30024306002752371159 -0.86119484175378047119 -0.55138915507026331486 1.6081313522847473507 -0.53814312515501372403 0.45910961662934807181 0.17185937182070318285 0.33118634329420859608 -0.40454994453997683568 -0.23015819229983572325;-0.67513449359787647275 -0.61937378159357492358 -0.10223415788358548861 1.0140807579430048957 0.10590562719077159515 -0.050309352031883254608 -0.18565273029352366563 -0.42348244050825933904 -0.22118639064288089791 0.56466028357607844779 -0.3953761523422050228 -0.15308780321290135773 -0.70547709074677789065 0.10252513079547460884 -0.057279215418240998769 1.0818308717641194061 0.026884561511619695789 -0.095630244632147323736 0.0017616964634456799312 -0.049159193772685648438 0.46225709869303793775 -0.10782200831489499593 -0.46311785585333464788 -0.17762020064475969594 -0.065592175243411529606 0.69563918815287384412 0.94303755177354142702 -0.80207536157067260696 0.029786519793256870797 -0.46330350002771936158 0.33511490861046588918 0.95599502184254170345 -0.81911155654362721723 0.69900209428154724822 1.2950134628837051132 0.47085532882808939226 1.0095831553857361751 0.55402283094478854686 -0.76743174385863865972 -0.027936710035077281372;0.45358692326237615156 -0.42983516077216221696 -0.09135888804114931927 0.083616072145124481496 0.15400311640647332267 -0.34102664593405951354 -0.30865010425670508232 0.2508268325168898083 0.023232785779135910892 0.61300258401802809605 -0.58565899570800006302 0.14581626319416782223 -0.093805226741094288601 -0.19776416590712375676 0.27885781008492716015 0.61361249615111834732 -0.040385973467956852445 0.27881327741812850229 -2.0428654034566839925 -0.020685889167749060141 1.3880263046792582493 1.625151167861786039 0.5758637395636183598 -0.15812644521747223902 -1.3406624116992813533 0.43887955246537679876 -0.041508222715810796921 -0.2877695301339761591 -0.067104493514438687263 -0.074380455492495264891 -0.1832779955860140142 0.45855805626592688329 0.41739316506844920118 0.25527709063717018978 -0.1213641376746394801 1.2628548947220468168 0.11127614089109875983 -1.3140685778553733432 0.51855341867216042662 -0.054723339867395588698;-1.5400407724146183419 -1.0045546813361574401 -0.90846700288052306682 -1.2015838155532880815 -0.55015301128607496661 0.5713573534208622462 -0.27704127753359819586 -0.27979589058829484882 0.21739969056828767346 0.4237738013659697045 -0.50762882785119434192 -0.1081226060071591305 1.178377417950790873 -0.84087416245014467986 -0.010657157892076961347 0.48107677635504575431 -0.21876225585905226256 0.90291656398813735507 -0.088710082626515279758 0.069801012110517257625 -0.00077248627413329913963 0.069989658952074818021 0.596356609923100911 0.32576350293533573588 0.20863805362970916368 -1.0098465010464607872 0.23108904460952531257 0.25745030114475331295 -1.2349383492081629221 -0.5750320835720010848 -0.17634875329551097378 0.18472634176722502186 0.21983411463349711301 -0.019119253814358271037 0.82388951517982667028 0.59519986387535872563 0.82941708679291359374 0.18311207116065414402 -0.45270705155555113208 1.2478448526120549111;1.3636016686721073032 1.0307335238178871872 -1.5488108602179659901 1.1282583802975230114 0.028319861738110539695 -0.49900986096653782154 0.51059647766143234637 1.2209935739923660769 0.3820066980880135743 0.0082303359217449460761 0.26267773469974636802 1.0049281107399177237 0.37109972336624269529 -0.78105096268567109075 -1.1771278155803965859 0.36905449218918395804 0.80938526564816715148 -0.063082978707282855169 0.46660010172545757223 1.1042731867623922781 -0.057140787875924026196 0.058265828557257988429 0.7507013089345607737 0.27208170145970894671 0.91555882713973513187 1.204607266710255864 -1.3624652503398986259 -0.83707886968335887268 -0.3799831753191615924 0.19357153339966623462 0.48003325558692822028 0.52116727754353409097 -0.58488693882173370397 -0.31893918469790705217 0.37424915226244703792 0.43778980089010449683 -0.70153829055154381944 -0.046505725946126147408 0.16634346283617038043 -0.077707103634168522843;-0.40296256246529260636 0.53390137199945608693 0.061402815219950876435 0.23352290583485538211 -0.97759169707147908213 1.6510593871601209059 0.14396221729288075086 -0.86070563281167233871 -0.90326290971148148756 -0.91987056890852125779 0.40455281894206890358 0.68263514087012444609 -0.051152231033091320744 -0.25504009283029921429 0.39716461194863211803 1.0276087855878364152 0.1570117598278671367 -0.93894855250492159637 0.6036329742180928104 0.23112836926654595215 0.17520448789538453638 -0.54595644527874176433 0.021956750137171639203 0.009671924701535035071 -0.60268394208267828116 0.062166509263249215833 -0.14245522974489810419 -0.68319986604565741128 0.88346004809175693318 0.2631255368293077268 0.79892275854318783868 -0.71364123512475419187 -1.1170359792643471675 0.044916915933809031802 0.24066258456380829056 0.20730021064231429762 -0.74079096241795705513 0.10912778999478503494 -0.80377166948760447873 -0.31074644194181449963;0.029069573286799623574 0.33472560720626259867 1.3855778916676002588 -0.1030169729381523458 0.9885299124401404347 -0.45497381435898276436 0.15435605051442247149 -0.24138799027097901373 -0.21355666908025919271 -0.26749672308349736749 2.0625567888154621166 0.16375458284248395335 1.3130570197361526308 -0.55881866735401919399 -0.073549560197076480073 -0.5885485816724133068 -0.10862689876546954837 0.078606156893109485617 -0.28053204650482299609 -0.47787180126208245179 -1.5119805511033337364 -0.092712425962360262011 0.23787952056582775673 1.0058816755381496666 0.80439167943444589426 0.11409422367411455046 -0.65104003886551931046 -0.37410458405844948526 0.56567993586698750441 0.38980928665300257352 -0.93720384765102149327 0.0278734681334102119 0.20953044015648969456 -0.10831145521775187301 0.49380140717328935285 -0.49673914525701101663 -0.059980584445549253725 0.69755057943161546952 0.26055371773154289983 -0.016292097325546310571;0.036720358567443017739 -0.7096310438933466358 -0.60442963767010537968 -0.56685205546494099593 -1.1264974869738915153 -0.15117754487572027111 -0.17130335757128178908 -0.52144334918606494167 -1.7475706051633723703 0.2278204180312360938 -0.15465371638418581868 0.016145912852527834896 0.90023874280004267945 -0.22577445731818196473 -0.53693221037427873998 0.791498941553412938 -0.50319780606363251341 2.0104331386769027645 -0.12047822455580509127 -0.45407565002010474853 -0.10452948534345830878 0.2102679376295486513 0.41014833494030028538 -0.29563275577355513368 -0.94894064754713103316 -0.49869289079904860484 -0.2873495711137746822 -0.24012776560979420815 0.25196625095396552041 0.0096026356344048914571 0.72331493556028603198 0.39242865338871329994 -0.017954109028043778451 -0.57399910719957858429 -1.158122377314717566 0.22773098784222178814 1.0479166514545166233 -0.11169661904085020909 -0.45720222154756562372 0.32884500049884773931;-0.37660034483819915252 0.19284220507433738612 -0.81592024171813382072 0.409955753831364067 -0.48524045083657318944 -0.59653622972022923854 1.027963826308180062 -0.069161908281971329338 -0.93621087928846358217 -0.534573402934516273 0.64951657806678875229 0.41739239696242141919 0.55375626733991289985 1.0676394675504736753 -0.01971945102154397042 -0.14456413252492192334 0.033120333710043310671 1.2482699021434302544 -0.31320831962146433725 1.1396302893383603028 0.1767696860948001214 -0.87742415917666582992 -0.9630793481759009067 0.12110648407773758062 0.37430718815267893795 0.38328153180157364943 -1.3515424927582586623 -0.20652210041155366627 1.0208663073555208634 0.17475522725403686009 0.15737120730774864508 0.84026369293593050624 -0.30982622808918885982 0.6645692876733454435 0.78373449243960513488 -1.2672282260189302594 -0.15290287487845258263 0.17733395502206183991 -0.070056473837625074519 -0.37564194239709736145;0.4485748925679769461 0.050327208555634918297 0.00023551800719709393116 0.14423638277022526877 0.42973782916549480015 -0.87851175411728887887 0.64167042466340618034 -0.68041703321416646677 -0.96357077405854107965 -0.78886565111048201349 0.7578153908521940707 -0.61148442471406672105 -0.061970242439160619363 -0.15535675348562699716 0.62085685827596814867 0.054795222803162790814 -0.51283074991803423437 -0.94715293614103202025 -0.70386152906573851151 -0.36425945400688197751 -0.42678186105268295369 -0.046912888735408810048 0.12085759122411805777 -0.43203000229532201315 -0.57311595077741184223 -0.89690139451037231844 -0.79540949770485336323 -0.86849198764803714479 0.44763954582599474463 -0.37588131783343881054 -0.67167666150441862616 -0.19100423570342695001 -0.62417215329900788134 -0.23288944084625765041 -0.31322157650241533311 -0.91897757736012086749 -0.81328734782082745536 -0.23253279908366911166 -0.06846796467709674594 -0.043042285361927543064;-0.61488061203654742481 0.9581881071685942608 0.41326589240300409811 0.27727764288566519868 0.11941815858742792222 0.070721482917758815567 -0.055254204385304712954 0.41331148900574338212 -0.012295864152047777246 1.7026453233094378525 -2.1771065087046856945 0.029817625279131915877 1.5310284188693388252 -0.96238511678321614351 0.015088524968799045187 -0.12860840878812490606 -0.83900884749193227474 0.042826034432894587167 -0.3836019894262542862 0.70591561544900371938 0.60308245015090578001 -0.20177627233378128691 -0.079156812159832390385 0.17289909449316703816 0.30797582765460951304 0.78343363054688330838 -0.64990805765330106336 -0.35386233483718054771 -0.30661926671312955683 0.2049855255405849952 0.68822637095623506731 0.70331784653948681285 -0.12922192609681165676 0.67902601764574233023 0.63723147801602364471 -0.10579616501072244827 1.2727274625520355045 0.086794122287828581741 0.045839431715984896298 -0.4251336273877868166;0.39497213769938793737 -0.11455210511326852085 0.016434204620364538385 0.37817821657712796801 0.43344381461068859362 0.64514945538210421994 0.42188516794944408428 0.18924379034810467903 -0.034525442106144263454 1.2798980283299927763 -0.90676864875531670851 1.0104787106552863829 0.93384994671181675852 1.1860878339673617266 -0.36852857621526796672 -0.30781854424578236618 0.051918231072415166327 -0.13304128046051355572 -0.34060987986200125244 -0.01694988573422049824 0.0011877434138390676171 0.079052708908123395237 0.007391928829882975574 -0.26711963107794794992 0.24604734921078141863 -0.68688713440109949726 -0.027194550809191170293 1.1017924928119426919 -0.24103002535054005029 -1.1309352263009582185 0.84992019106031679865 0.042021883949107982636 -0.69834057183933484492 -0.49487714314525049764 0.67082434299721804827 0.53042720811912003054 -0.3504895148010888084 -0.49654227849443771658 -1.1024429077056465687 -0.27078691167658075489;-0.14008959493881864566 0.55159127158782261802 0.42130732656145669646 0.36680164266564357911 0.6270275047074969077 -0.073195828450168323731 -1.4829507106173271946 1.5429591452756916681 0.11714089536193145191 -0.72934300798645457231 0.87368405684197780747 0.3924179662693877968 -0.73751340122432540447 -0.020324906473754393577 0.28097845391499776113 0.34209856830013213314 -1.4602235452683018924 -0.23810244544592995553 0.090303202130170415196 0.070004096744280958076 -0.0030028676041899717009 -0.3283914351065238546 -0.62450845641132335384 -0.68840269272785359345 -0.42631696010633202132 0.36674662337142815982 -0.70925573639109840141 0.039997883045030088733 0.75399336868191302319 0.49628306579835845813 -0.58971398419773679578 -0.90998634289412272391 -0.370655584320192244 0.12646444486901542437 0.039346023019949792621 -0.012820915675230725936 -0.27920643663982175342 -1.7151993978194430834 -0.1111641508431626818 -0.085844336968928861009;0.60457201119543724221 -0.19949003097420048292 -0.77297709929207603086 0.31926932832877757962 0.72632200588078932313 -1.7283125032184580849 0.026238238897883309902 0.25604746070172162975 0.30273008294644415672 0.2482080999661333276 0.076733094094833809162 -0.4049092779944494791 -0.90567142280221146766 -0.82215507427927481121 0.88474140047662819253 -0.38783826658609421578 0.60558217201407082975 0.25285670339515070593 -0.39883673758446308577 0.062190042826573303791 0.15880306738329819094 0.10547259501554102912 0.19157891618832048608 -0.61010989498934720121 -0.76713588470367932715 -0.19229577618789184257 0.11290646568924922466 -0.90753095086116819523 0.2878894920984046979 0.46264989017899033064 -0.48040887894481304476 -0.98546077705336210251 -0.88919585890482744084 -0.029570611193203106409 -0.45667871583735764052 -0.31956273319403655231 -0.52645914796174719807 0.080420633032220897873 1.4203275534827493054 0.13441127624182377942];

% Layer 3
b3 = [0.23490120803516670311;-0.34566678632052649789];
LW3_2 = [-0.072750743022151814765 1.6650656835295702951 0.33572458553762069 -0.3483236653382787984 -0.61500336890835938242 0.46385957150500467527 0.48221595929543958903 0.74544536796271132495 0.56189111151647830322 -0.41047747631783720879 -0.30419104539873065285 0.39406942669477479368 -0.61192631245051587463 -1.3068557436685219741 -3.0714076529453304687 -0.77816776307390889134 1.7131113576403835808 -0.44385723973110835505 0.84234336734720050011 -1.3270267017168422274 -0.73757336133975448522 0.11496074927079978634 -0.41384205881876728883 0.89723299992363203526 0.61130107283213819258 1.0271339030385606694 -0.35334467345128817151 0.64819552945834013613 1.6954108969238530502 0.51499990074946122576 2.0232926797141579378 0.33306758521971085996 -1.1254781003230791558 -1.0549455144226291825 -0.51915749400329169738 0.54502273973872006341 -2.4538398062058113247 0.021959077859495450963 -0.94297539427970711312 0.36503423326839651297;-1.2995840584737052836 0.10200438932555647153 1.5477203191488928535 0.0025016257350296468992 0.031863381979883566297 -0.044649038693287589064 0.16068554959443237529 0.71105807282237643019 0.014609596897878933397 -0.059284392675565983355 0.25507835347209362187 0.31673496994365446522 -0.012653888142699864366 -0.080693339986527515273 -0.32381695306151847547 -0.57037251211292860908 0.31213249138009924177 -0.43272786012015529433 0.12600062058062705406 -0.031318962659696754358 0.037843547789161012529 0.31679051796128843144 -0.091514060007982137024 -0.12489656321663875072 -0.26962099219718971277 -0.16727699326684755676 0.08238873918443520572 0.0050444284749764202805 0.16631976249616312047 -0.020346401655323063246 0.038148305276965950583 1.1559024839190150669 -0.017789081629344546953 -0.36110955121958349112 0.31906208247701878244 0.72141517872646543363 -0.20321195280588794096 0.29531663882642511521 -0.1158960536855594553 -0.59006351753593844212];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [3.92152398248882;0.243393456647019];
y1_step1.xoffset = [1.67108328040712e-08;-4.10857388598679];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = poslin_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = poslin_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Linear Positive Transfer Function
function a = poslin_apply(n,~)
  a = max(0,n);
  a(isnan(n)) = nan;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
